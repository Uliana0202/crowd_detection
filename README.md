# Тестовое задание Сrowd detection
## Описание проекта
### fine-tuning
Для задачи детекции была выбрана модель YOLO11. Также данная модель была дообучена на датасете [CrowdHuman](https://www.kaggle.com/datasets/permanalwep/crowdhuman-crowd-detection/data).  

Полученные при обучении веса сохранены в `weights/best.pt` и используются основным приложением. Ноутбук `training/train_on_kaggle.ipynb` адаптирован для Kaggle и служит документацией дообучения, для работы основного приложения он необязателен.  

Реализован алгоритм ByteTrack. Он решает проблему того, что при перекрытии человека другим человеком или предметом его рамка пропадает.  
Реализовано асинхронное чтение видео с использованием многопоточности.  
Реализована (опционально) поддержка нарезки кадров для детекции малых объектов на дальних планах.  

## Установка
Проект протестирован на Python 3.10.10
1. Клонируйте репозиторий:
```
git clone https://github.com/Uliana0202/crowd_detection.git
cd crowd_detection
```
2. Установите зависимости:
```
pip install -r requirements.txt
```
## Запуск
Перед запуском поместите исходный файл crowd.mp4 в папку media/

### Стандартный режим (Рекомендуемый)
```
python main.py
```
###  Режим SAHI
```
python main.py --sahi
```
###  Расширенные настройки
```
python main.py --source media/crowd.mp4 --weights weights/best.pt --output output.mp4 --sahi
```
Описание аргументов:
| Аргумент | Описание | Значение по умолчанию |
| :--- | :--- | :--- |
| `--source` | Путь к входному видео | `media/crowd.mp4` |
| `--weights` | Путь к весам модели (`.pt`) | `weights/best.pt` |
| `--output` | Путь для сохранения результата | `output.mp4` |
| `--sahi` | Флаг для включения режима нарезки кадров (SAHI) | Отключено (False) |
